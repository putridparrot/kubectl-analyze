[
  {
    "name": "Minimum Replicas",
    "description": "Deployments should have at least 2 replicas",
    "resource": "Deployment",
    "jsonpath": "$.spec.replicas",
    "operator": ">=",
    "value": 2,
    "category": "Availability",
    "severity": "Information"
  },
  {
    "name": "Pod Must Have Labels",
    "description": "Pods must include at least one label",
    "resource": "Pod",
    "jsonpath": "$.metadata.labels",
    "operator": "!=",
    "value": null,
    "category": "Configuration",
    "severity": "Warning"
  },
  {
    "name": "Service Must Be ClusterIP",
    "description": "Services must default to ClusterIP type",
    "resource": "Service",
    "jsonpath": "$.spec.type",
    "operator": "==",
    "value": "ClusterIP",
    "category": "Networking",
    "severity": "Warning"
  },
  {
    "name": "Pod Must Not Run As Root",
    "description": "Pods must run as non-root user",
    "resource": "Pod",
    "jsonpath": "$.spec.securityContext.runAsNonRoot",
    "operator": "==",
    "value": true,
    "category": "Security",
    "severity": "Warning"
  },
  {
    "name": "Image Pull Policy Always",
    "description": "Containers must always pull latest image",
    "resource": "Pod",
    "jsonpath": "$.spec.containers[*].imagePullPolicy",
    "operator": "==",
    "value": "Always",
    "category": "Security",
    "severity": "Warning"
  },
  {
    "name": "CPU Requests Required",
    "description": "Containers must define CPU requests",
    "resource": "Pod",
    "jsonpath": "$.spec.containers[*].resources.requests.cpu",
    "operator": "!=",
    "value": null,
    "category": "Resources",
    "severity": "Warning"
  },
  {
    "name": "Memory Limits Required",
    "description": "Containers must define memory limits",
    "resource": "Pod",
    "jsonpath": "$.spec.containers[*].resources.limits.memory",
    "operator": "!=",
    "value": null,
    "category": "Resources",
    "severity": "Warning"
  },
  {
    "name": "Ingress Must Use TLS",
    "description": "Ingress resources must define TLS",
    "resource": "Ingress",
    "jsonpath": "$.spec.tls",
    "operator": "!=",
    "value": null,
    "category": "Networking",
    "severity": "Warning"
  },
  {
    "name": "Service Must Have Selector",
    "description": "Services must target pods via selector",
    "resource": "Service",
    "jsonpath": "$.spec.selector",
    "operator": "!=",
    "value": null,
    "category": "Networking",
    "severity": "Warning"
  },
  {
    "name": "Deployment Strategy Required",
    "description": "Deployments must define update strategy",
    "resource": "Deployment",
    "jsonpath": "$.spec.strategy.type",
    "operator": "!=",
    "value": null,
    "category": "Operational",
    "severity": "Warning"
  },
  {
    "name": "ConfigMap Must Have Data",
    "description": "ConfigMaps must contain at least one key-value pair",
    "resource": "ConfigMap",
    "jsonpath": "$.data",
    "operator": "!=",
    "value": null,
    "category": "Operational",
    "severity": "Warning"
  },
  {
    "name": "Service Must Not Use ExternalIPs",
    "description": "Services must not expose external IPs directly",
    "resource": "Service",
    "jsonpath": "$.spec.externalIPs",
    "operator": "==",
    "value": null,
    "category": "Networking",
    "severity": "Warning"
  },
  {
    "name": "LoadBalancer Must Have Ingress IP",
    "description": "LoadBalancer services must define ingress IPs",
    "resource": "Service",
    "jsonpath": "$.status.loadBalancer.ingress[*].ip",
    "operator": "!=",
    "value": null,
    "category": "Networking",
    "severity": "Warning"
  },
  {
    "name": "Minimum Replicas",
    "description": "Deployments should have at least 2 replicas",
    "resource": "Deployment",
    "jsonpath": "$.spec.replicas",
    "operator": ">=",
    "value": 2,
    "category": "Availability",
    "severity": "Information"
  },
  {
    "name": "Privileged Container Check",
    "description": "Containers should not run in privileged mode",
    "resource": "Pod",
    "jsonpath": "$.spec.containers[*].securityContext.privileged",
    "operator": "!=",
    "value": true,
    "category": "Security",
    "severity": "Critical"
  },
  {
    "name": "Image Tag Check",
    "description": "Images should not use the 'latest' tag",
    "resource": "Pod",
    "jsonpath": "$.spec.containers[*].image",
    "operator": "notContains",
    "value": ":latest",
    "category": "Configuration",
    "severity": "Warning"
  },
  {
    "name": "RollingUpdate Strategy",
    "description": "Deployments should use RollingUpdate strategy with maxUnavailable < 50%",
    "resource": "Deployment",
    "jsonpath": "$.spec.strategy.type",
    "operator": "==",
    "value": "RollingUpdate",
    "category": "Reliability",
    "severity": "Warning"
  },
  {
    "name": "HPA Presence",
    "description": "Scalable workloads should define a HorizontalPodAutoscaler",
    "resource": "HorizontalPodAutoscaler",
    "jsonpath": "$.spec.scaleTargetRef.kind",
    "operator": "exists",
    "value": null,
    "category": "Scalability",
    "severity": "Warning"
  },
  {
    "name": "HPA Minimum Replicas",
    "description": "HPA should define minReplicas >= 2",
    "resource": "HorizontalPodAutoscaler",
    "jsonpath": "$.spec.minReplicas",
    "operator": ">=",
    "value": 2,
    "category": "Availability",
    "severity": "Information"
  },
  {
    "name": "HPA Max Replicas",
    "description": "HPA should define a maxReplicas value",
    "resource": "HorizontalPodAutoscaler",
    "jsonpath": "$.spec.maxReplicas",
    "operator": "exists",
    "value": null,
    "category": "Scalability",
    "severity": "Critical"
  },
  {
    "name": "HPA Metrics Defined",
    "description": "HPA should define CPU or memory utilization metrics",
    "resource": "HorizontalPodAutoscaler",
    "jsonpath": "$.spec.metrics[*].resource.name",
    "operator": "in",
    "value": ["cpu","memory"],
    "category": "Performance",
    "severity": "Warning"
  },
  {
    "name": "HPA Target Utilization",
    "description": "CPU utilization target should be between 50 and 80 percent",
    "resource": "HorizontalPodAutoscaler",
    "jsonpath": "$.spec.metrics[*].resource.target.averageUtilization",
    "operator": "between",
    "value": [50,80],
    "category": "Performance",
    "severity": "Information"
  }
]